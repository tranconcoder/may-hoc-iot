      if (!cameraId || !apiKey)
/* ----------------------------- <!DOCTYPE html> ---------------------------- */
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser Tab Capture</title>
    <link rel="stylesheet" href="/public/css/capture.css">
    <meta name="theme-color" content="#4CAF50">
    <!-- Thêm các headers đặc biệt để ngăn chặn việc browser throttle -->
    <meta http-equiv="Page-Enter" content="RevealTrans(Duration=2.0,Transition=2)">
    <meta http-equiv="Page-Exit" content="RevealTrans(Duration=3.0,Transition=12)">
</head>
<body>
    <div class="container">
        <h1>Browser Tab Capture</h1>
        
        <div class="video-container">
            <video id="preview" autoplay muted></video>
            <canvas id="canvas"></canvas>
            <canvas id="processingCanvas"></canvas>
        </div>
        
        <div class="controls">
            <button id="startBtn">Start Capture</button>
            <button id="stopBtn" class="stop" disabled>Stop Capture</button>
        </div>
        
        <div class="status" id="status">Not connected</div>
        <div class="frame-counter" id="frameCounter">Frames: 0 | FPS: 0</div>
        
        <div class="settings">
            <div class="settings-group">
                <span class="settings-title">Capture Settings</span>
                <div>
                    <label for="sourceType">Source Type:</label>
                    <select id="sourceType">
                        <option value="display" selected>Entire Screen</option>
                        <option value="window">Application Window</option>
                        <option value="tab">Browser Tab</option>
                    </select>
                </div>
                <div>
                    <label for="resolution">Resolution:</label>
                    <select id="resolution">
                        <option value="1280,720" selected>HD (1280x720)</option>
                        <option value="1920,1080">Full HD (1920x1080)</option>
                        <option value="640,480">SD (640x480)</option>
                        <option value="320,240">Low (320x240)</option>
                    </select>
                </div>
            </div>
            
            <div class="settings-group">
                <span class="settings-title">Frame Rate Control</span>
                <div>
                    <label for="fpsMode">FPS Mode:</label>
                    <select id="fpsMode">
                        <option value="unlimited">Unlimited (Maximum)</option>
                        <option value="limited" selected>Limited</option>
                    </select>
                </div>
                
                <div id="fpsLimitContainer">
                    <label for="frameRate">Target FPS:</label>
                    <select id="frameRate">
                        <option value="5">5 FPS</option>
                        <option value="10">10 FPS</option>
                        <option value="15" selected>15 FPS</option>
                        <option value="20">20 FPS</option>
                        <option value="30">30 FPS</option>
                        <option value="60">60 FPS</option>
                    </select>
                </div>
            </div>
            
            <div class="settings-group">
                <span class="settings-title">Quality Settings</span>
                <div>
                    <label for="quality">JPEG Quality:</label>
                    <select id="quality">
                        <option value="0.7" selected>Medium (70%)</option>
                        <option value="0.85">High (85%)</option>
                        <option value="1.0">Maximum (100%)</option>
                        <option value="0.5">Low (50%)</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="log" id="log"></div>
    </div>

    <!-- Load JavaScript modules -->
    <script src="/public/scripts/capture/anti-throttle.js"></script>
    <script src="/public/scripts/capture/capture-engine.js"></script>
    <script src="/public/scripts/capture/main.js"></script>
    <script>
        // Khởi tạo tính năng chống browser throttle ngay khi trang web được tải
        document.addEventListener('DOMContentLoaded', function() {
            // Khởi tạo video giả để giữ cho browser luôn xử lý video
            BrowserKeepAlive.setupFakeVideo();
        });
    </script>
</body>
</html>
